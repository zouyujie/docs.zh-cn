---
title: "“&lt;variablename&gt;”的类型不明确，因为循环边界和步骤变量未扩大到同一类型 | Microsoft Docs"
ms.custom: ""
ms.date: "11/17/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vbc30983"
  - "bc30983"
helpviewer_keywords: 
  - "BC30983"
ms.assetid: 6b97153c-dee3-4429-b92a-2e5a212c864b
caps.latest.revision: 14
caps.handback.revision: 14
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# “&lt;variablename&gt;”的类型不明确，因为循环边界和步骤变量未扩大到同一类型
你的代码包含 `For...Next` 循环，编译器在其中无法为循环控制变量推断数据类型，因为满足以下条件：  
  
-   未在 `As` 子句中指定循环控制变量的数据类型。  
  
-   循环边界和步骤变量包含至少两种数据类型。  
  
-   数据类型之间存在多个可能的转换。  
  
-   候选项中没有最佳类型，因此循环控制变量的类型选择不明确。  
  
 例如，下面的循环具有一个类型为 `Integer` 的循环边界，以及一个类型为 `UInteger` 的循环边界：  
  
```vb#  
Dim m As Integer = 1 Dim n As UInteger = 10 ' Not valid. ' For i = m To n ' Loop processing. ' Next  
```  
  
 `Integer` 与 `UInteger` 之间存在可能的转换，并且 `UInteger` 与 `Integer` 之间存在可能的长肉，但是两者都是收缩转换，因此都不是最佳选择。  
  
 在下一个示例中，添加类型为 `Double` 的第三个变量。`Integer` 和 `UInteger` 都具有对 `Double` 的标准扩大转换，这使转换为 `Double` 是最佳选择。 类型推断向循环控制变量 `i` 分配了数据类型 `Double`。  
  
```vb#  
Dim stepVar As Double = 1 ' Valid. For i = m To n Step stepVar ' Loop processing. Next  
```  
  
 **错误 ID：**BC30983  
  
### 更正此错误  
  
-   将一个变量显式转换为其他变量可以扩大转换为的类型，例如：  
  
    ```  
    For i = m To CLng(n)  
    ```  
  
-   使用 `As` 子句指定控制变量的类型：  
  
    ```  
    For i As Double = m To n   
    ```  
  
## 请参阅  
 [For...Next 语句](../../visual-basic/language-reference/statements/for-next-statement.md)   
 [隐式转换和显式转换](../../visual-basic/programming-guide/language-features/data-types/implicit-and-explicit-conversions.md)   
 [局部类型推理](../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)   
 [Option Infer 语句](../../visual-basic/language-reference/statements/option-infer-statement.md)   
 [扩大转换和收缩转换](../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)